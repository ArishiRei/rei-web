# Internationalization Development Guide (I18n)

This project uses the `@nuxtjs/i18n` module for internationalization management.

## Directory Structure

Language files are uniformly stored in the `app/i18n/locales/` directory:

```text
app/i18n/locales/
├── en.json       # English (default)
├── zh.json       # Simplified Chinese
└── ...
```

## Translation Key Naming Convention

Use a **module.function.semantic** three-level naming method, all lowercase, separated by underscores.

- **Good**: `auth.login.submit_btn`, `blog.post.read_more`
- **Bad**: `submit`, `ReadMore`, `authLoginButton`

## Usage Guide

### 1. In Vue Templates

Use the `$t()` function:

```vue
<template>
  <ReiButton>{{ $t('auth.login.submit_btn') }}</ReiButton>
</template>
```

### 2. In Script

Use the `useI18n()` composable:

```typescript
<script setup lang="ts">
const { t } = useI18n()

const title = computed(() => t('page.home.title'))
</script>
```

### 3. Adding New Languages

1. Create a new JSON file in `app/i18n/locales/` (e.g. `ja.json`).
2. Register the new language in the `i18n` configuration in `nuxt.config.ts`:

```typescript
// nuxt.config.ts
export default defineNuxtConfig({
  i18n: {
    locales: [
      { code: 'en', file: 'en.json' },
      { code: 'zh', file: 'zh.json' },
      { code: 'ja', file: 'ja.json' } // New addition
    ]
  }
})
```

## Advanced Usage

### 1. Translations with Parameters

```json
// en.json
{
  "user": {
    "welcome": "Welcome back, {name}!",
    "items_count": "You have {count} items"
  }
}
```

```vue
<template>
  <div>
    <p>{{ $t('user.welcome', { name: userName }) }}</p>
    <p>{{ $t('user.items_count', { count: itemCount }) }}</p>
  </div>
</template>
```

### 2. Plural Form Handling

```json
// en.json
{
  "item": {
    "count": "no items | one item | {count} items"
  }
}
```

```vue
<template>
  <p>{{ $tc('item.count', itemCount, { count: itemCount }) }}</p>
</template>
```

### 3. Date and Number Formatting

```typescript
const { d, n } = useI18n()

// Date formatting
const formattedDate = d(new Date(), 'short')

// Number formatting
const formattedNumber = n(1234.56, 'currency')
```

### 4. Dynamic Language Switching

```vue
<template>
  <select v-model="$i18n.locale">
    <option value="en">English</option>
    <option value="zh">中文</option>
  </select>
</template>

<script setup lang="ts">
const { locale, setLocale } = useI18n()

// Programmatic language switching
const switchLanguage = (lang: string) => {
  setLocale(lang)
}
</script>
```

## Configuration Options

### Basic Configuration

```typescript
// nuxt.config.ts
export default defineNuxtConfig({
  i18n: {
    locales: [
      {
        code: 'en',
        file: 'en.json',
        name: 'English'
      },
      {
        code: 'zh',
        file: 'zh.json',
        name: '中文'
      }
    ],
    defaultLocale: 'en',
    strategy: 'prefix_except_default',
    detectBrowserLanguage: {
      useCookie: true,
      cookieKey: 'i18n_redirected',
      redirectOn: 'root'
    }
  }
})
```

### SEO Optimization

```typescript
// nuxt.config.ts
export default defineNuxtConfig({
  i18n: {
    baseUrl: 'https://example.com',
    seo: true,
    pages: {
      about: {
        en: '/about',
        zh: '/guanyu'
      }
    }
  }
})
```

## Best Practices

### 1. Translation File Organization

```json
// Recommended file structure
{
  "common": {
    "save": "Save",
    "cancel": "Cancel",
    "confirm": "Confirm"
  },
  "nav": {
    "home": "Home",
    "about": "About",
    "contact": "Contact"
  },
  "auth": {
    "login": {
      "title": "Login",
      "email": "Email",
      "password": "Password",
      "submit": "Login"
    }
  }
}
```

### 2. Type Safety

```typescript
// types/i18n.ts
export interface I18nMessages {
  common: {
    save: string
    cancel: string
  }
  auth: {
    login: {
      title: string
      email: string
    }
  }
}

// Use typed translations
const { t } = useI18n<I18nMessages>()
const title = t('auth.login.title') // Type safe
```

### 3. Lazy Loading Translations

```typescript
// nuxt.config.ts
export default defineNuxtConfig({
  i18n: {
    lazy: true,
    langDir: 'locales/',
    locales: [
      {
        code: 'en',
        file: 'en.json'
      },
      {
        code: 'zh',
        file: 'zh.json'
      }
    ]
  }
})
```

### 4. Translation Validation

```bash
# Check for missing translation keys
pnpm i18n:check

# Auto-generate translation templates
pnpm i18n:generate
```

## Common Issues

### 1. Translations Not Working

Check the following:
- Confirm translation keys are correct
- Check JSON file syntax is correct
- Confirm language files are loaded correctly

### 2. Route Internationalization

```typescript
// pages/about.vue
<script setup lang="ts">
// Auto-generates /en/about and /zh/guanyu routes
definePageMeta({
  nuxtI18n: {
    en: 'about',
    zh: 'guanyu'
  }
})
</script>
```

### 3. Server-Side Rendering Issues

```typescript
// Ensure server and client language consistency
const { locale } = useI18n()

onMounted(() => {
  // Language handling after client mount
  if (process.client) {
    // Client-specific logic
  }
})
```

## Related Documentation

- [Vue I18n Official Documentation](https://vue-i18n.intlify.dev/)
- [Nuxt I18n Module Documentation](https://i18n.nuxtjs.org/)
- [Theming System](./theming.md) - Multi-language theme adaptation