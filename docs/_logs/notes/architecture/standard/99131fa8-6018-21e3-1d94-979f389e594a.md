---
id: 99131fa8-6018-21e3-1d94-979f389e594a
title: Nuxt 4 开发规范与目录结构设计
category: architecture/standard
tags:
    - nuxt4
    - standard
    - architecture
created_at: 2025-12-23T13:18:11.0163362+08:00
updated_at: 2025-12-23T13:18:11.0163362+08:00
---

## File: docs/_logs/temp.md
# Nuxt 4 开发规范与目录结构设计
Date: 2025-12-22 17:10
## Actions
1. 无依赖安装
2. 开发逻辑与步骤：
   - 制定基于 Nuxt 4 拆分上下文（Split Context）架构的目录结构规范。
   - 定义全局配置与常量管理的最佳实践。
   - 确立代码风格与注释规范。
3. 规范文档内容如下：

---

### 1. 目录结构规范 (Directory Structure)

基于 Nuxt 4 推荐的 **Split Context Architecture**，将应用（App）、服务端（Server）与共享逻辑（Shared）严格分离。

```bash
root/
├── app/                        # [Frontend] 客户端/Vue 应用逻辑
│   ├── assets/                 # 静态资源 (SCSS, Fonts, Images)
│   │   ├── styles/             # 全局样式与变量
│   │   └── ...
│   ├── components/             # Vue 组件
│   │   ├── base/               # 基础 UI 组件 (原子级)
│   │   ├── domain/             # 业务领域组件 (复合级)
│   │   └── layout/             # 布局相关组件
│   ├── composables/            # 组合式函数 (Auto-imported)
│   ├── constants/              # [Frontend] 前端专用常量
│   ├── layouts/                # 页面布局
│   ├── middleware/             # 路由中间件
│   ├── pages/                  # 页面路由
│   ├── plugins/                # Vue/Nuxt 插件
│   ├── stores/                 # Pinia 状态管理
│   ├── types/                  # [Frontend] 前端专用类型定义
│   ├── utils/                  # [Frontend] 前端工具函数
│   ├── app.vue                 # 应用入口组件
│   └── error.vue               # 错误处理页面
├── server/                     # [Backend] Nitro 服务端逻辑
│   ├── api/                    # API 路由 (/api/*)
│   ├── middleware/             # 服务端中间件
│   ├── plugins/                # Nitro 插件
│   ├── routes/                 # 自定义服务端路由
│   ├── utils/                  # [Backend] 服务端工具函数
│   └── tsconfig.json           # 服务端 TS 配置
├── shared/                     # [Shared] 前后端共享代码
│   ├── constants/              # 全局共享常量 (如 API 路径、枚举)
│   ├── types/                  # 全局共享类型 (DTO, Models)
│   └── utils/                  # 纯函数工具 (无副作用，无 Vue/Nitro 依赖)
├── content/                    # Nuxt Content 内容源 (Markdown/JSON)
├── public/                     # 纯静态资源 (favicon, robots.txt)
├── docs/                       # 项目文档与日志
├── nuxt.config.ts              # Nuxt 配置文件
└── tsconfig.json               # 全局 TS 配置
```

### 2. 全局配置与常量设计 (Configuration & Constants)

**原则**：禁止代码中出现魔法值（Magic Numbers/Strings），所有配置必须集中管理。

#### 2.1 环境变量 (Environment Variables)
- **文件**: `.env` (本地开发), 部署平台环境变量 (生产)
- **验证**: 使用 Zod 或 Joi 在 `nuxt.config.ts` 中验证环境变量。
- **访问**:
  - 服务端: `process.env.XXX` 或 `useRuntimeConfig()`
  - 客户端: `useRuntimeConfig().public.XXX`

#### 2.2 常量定义 (Constants)
- **共享常量**: 存放在 `shared/constants/`。
  ```typescript
  // shared/constants/auth.ts
  export const AUTH_TOKEN_KEY = 'auth_token' as const;
  export enum UserRole { ADMIN = 'admin', USER = 'user' }
  ```
- **应用常量**: 存放在 `app/constants/`。
  ```typescript
  // app/constants/ui.ts
  export const UI_DRAWER_WIDTH = 256 as const;
  ```

#### 2.3 全局配置 (App Config)
- 使用 `app.config.ts` 管理运行时可动态更新的配置（如主题色、功能开关）。
- **禁止**在此存放敏感信息（API Keys）。

### 3. 代码设计规范 (Code Design)

#### 3.1 Vue 组件 (SFC)
- **命名**: PascalCase (如 `UserProfile.vue`)。
- **结构**:
  ```vue
  <script setup lang="ts">
  // 1. Imports (Vue -> Nuxt -> Local)
  // 2. Props & Emits
  // 3. State (ref/reactive)
  // 4. Computed
  // 5. Methods
  // 6. Lifecycle Hooks
  </script>

  <template>
    <!-- 根元素尽量单一 -->
  </template>

  <style scoped>
    /* 尽量使用 CSS Variables */
  </style>
  ```

#### 3.2 状态管理 (Pinia)
- **Setup Stores**: 优先使用 Setup Syntax (`defineStore('id', () => { ... })`)。
- **持久化**: 需持久化的状态显式配置 `persist: true`。
- **职责**: Store 仅负责状态变更，API 调用应在 Service 层或 Composable 中处理。

#### 3.3 异步数据 (Data Fetching)
- **封装**: 所有 API 调用封装在 `app/composables/useApi.ts` 或特定业务 Composable 中。
- **工具**: 使用 `useFetch` 或 `$fetch`，避免直接使用 `axios`。
- **类型**: 必须定义 Request/Response 类型（推荐在 `shared/types`）。

### 4. 代码注释规范 (Comments)

**原则**: 代码即文档，注释仅解释 "Why" 而非 "What"。

#### 4.1 文件头注释
每个核心文件顶部应简述文件职责。
```typescript
/**
 * @file app/utils/format.ts
 * @description 全局日期与金额格式化工具
 * @author ArishiRei
 */
```

#### 4.2 函数注释 (JSDoc)
公共函数必须包含 JSDoc。
```typescript
/**
 * 计算订单总金额
 * @param items - 订单项列表
 * @param discount - 折扣率 (0-1)
 * @returns 折后总金额
 */
export const calculateTotal = (items: OrderItem[], discount: number): number => { ... }
```

#### 4.3 特殊标记
- `TODO`: 待办事项
- `FIXME`: 待修复的缺陷
- `NOTE`: 重要提示
- `[未来扩展]`: 架构预留接口（如当前项目中使用的标记）

### 5. 规范规则 (Linting & Formatting)

- **ESLint**: 强制启用 `@nuxt/eslint`。
- **Prettier**: 集成在 ESLint 中或独立运行，保持代码风格一致。
- **Git Hooks**: 使用 `husky` + `lint-staged` 在提交前强制执行 Lint。

---
## Summary
已生成基于 Nuxt 4 Split Context 架构的完整开发规范文档，涵盖目录结构、配置管理、代码设计与注释规范。
