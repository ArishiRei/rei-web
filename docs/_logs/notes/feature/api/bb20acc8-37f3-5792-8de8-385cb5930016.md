---
id: bb20acc8-37f3-5792-8de8-385cb5930016
title: API 层与 Mock 策略实现
category: feature/api
tags:
    - api
    - mock
    - composable
created_at: 2025-12-23T14:01:13.3699022+08:00
updated_at: 2025-12-23T14:01:13.3699022+08:00
---

## File: docs/_logs/temp.md
# API 层与 Mock 策略实现
Date: 2025-12-22 18:05
## Actions
1. 无依赖安装
2. 开发逻辑与步骤：
   - **前端封装**: 创建 `app/composables/useApi.ts`，基于 `useFetch` 封装了 Token 注入、统一错误处理（401/403/500）和动态 Base URL 逻辑。
   - **环境配置**: 
     - 在 `nuxt.config.ts` 中配置 `runtimeConfig.public.apiBase`。
     - 更新 `.env.example` 添加 `NUXT_PUBLIC_API_BASE`。
   - **后端 Mock**: 创建 `server/api/blog/posts.get.ts`，模拟返回博客文章数据。
   - **规范更新**: 同步更新 `docs/prompt.md`，明确 API 请求必须使用 `useApi` 并遵循 Mock 策略。
3. 问题与解决：
   - 解决了 Token 注入时的类型兼容性问题。
   - 实现了基于环境变量的内外网 API 自动切换。
